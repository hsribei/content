    <h2 id="step-3-countymapcountymap.js">Step 3: CountyMap/CountyMap.js</h2>
    <p>
      Here comes the fun part - declaratively drawing a map. Youâ€™ll see why I
      love using React for dataviz.
    </p>
    <p>
      Weâ€™re using the
      <a
        href="https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887740#full-feature-integration"
        >full-feature integration</a
      >
      approach and a lot of D3 maps magic. Drawing a map with D3 Iâ€™m always
      surprised how little code it takes.
    </p>
    <p>
      Start with the imports: React, D3, lodash, topojson, County component.
    </p>
    <div
      class="sourceCode"
      id="cb69"
      data-caption="Import CountyMap dependencies"
      style="overflow: visible; margin: 1em 0;"
    >
      <pre
        class="sourceCode javascript"
        style="overflow: visible; margin: 0;"
      ><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb69-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// src/components/CountyMap/CountyMap.js</span></a>
<a class="sourceLine" id="cb69-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> React<span class="op" style="color: #666666;">,</span> <span class="op" style="color: #666666;">{</span> Component <span class="op" style="color: #666666;">}</span> <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;react&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb69-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> <span class="op" style="color: #666666;">*</span> <span class="im">as</span> d3 <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;d3&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb69-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> <span class="op" style="color: #666666;">*</span> <span class="im">as</span> topojson <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;topojson&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb69-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> _ <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;lodash&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb69-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb69-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> County <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;./County&#39;</span><span class="op" style="color: #666666;">;</span></a></code></pre>
    </div>
    <p>
      Out of these, we havenâ€™t built
      <code style="white-space: pre-wrap;">County</code> yet, and you havenâ€™t
      seen <code style="white-space: pre-wrap;">topojson</code> before.
    </p>
    <p>
      TopoJSON is a geographical data format based on JSON. Weâ€™re using the
      <code style="white-space: pre-wrap;">topojson</code> library to translate
      our geographical datasets into GeoJSON, which is another way of defining
      geo data with JSON.
    </p>
    <p>
      I donâ€™t know why there are two, but TopoJSON produces smaller files, and
      GeoJSON can be fed directly into D3â€™s geo functions. Â¯\<em>(ãƒ„)</em>/Â¯
    </p>
    <p>
      Maybe itâ€™s a case of
      <a href="https://xkcd.com/927/">competing standards</a>.
    </p>
    <h3 id="constructor">Constructor</h3>
    <p>
      We stub out the
      <code style="white-space: pre-wrap;">CountyMap</code> component then fill
      it in with logic.
    </p>
    <div
      class="sourceCode"
      id="cb70"
      data-caption="CountyMap stub"
      style="overflow: visible; margin: 1em 0;"
    >
      <pre
        class="sourceCode javascript"
        style="overflow: visible; margin: 0;"
      ><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb70-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// src/components/CountyMap/CountyMap.js</span></a>
<a class="sourceLine" id="cb70-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="kw" style="color: #007020; font-weight: bold;">class</span> CountyMap <span class="kw" style="color: #007020; font-weight: bold;">extends</span> Component <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="at" style="color: #7d9029;">constructor</span>(props) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">super</span>(props)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb70-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">state</span> <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb70-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb70-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">static</span> <span class="at" style="color: #7d9029;">getDerivedStateFromProps</span>(props<span class="op" style="color: #666666;">,</span> state) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb70-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="at" style="color: #7d9029;">render</span>() <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">const</span> <span class="op" style="color: #666666;">{</span> usTopoJson <span class="op" style="color: #666666;">}</span> <span class="op" style="color: #666666;">=</span> <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">props</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb70-16" title="16" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-17" title="17" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="cf" style="color: #007020; font-weight: bold;">if</span> (<span class="op" style="color: #666666;">!</span>usTopoJson) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-18" title="18" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="kw" style="color: #007020; font-weight: bold;">null</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb70-19" title="19" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span><span class="cf" style="color: #007020; font-weight: bold;">else</span><span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb70-20" title="20" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="cf" style="color: #007020; font-weight: bold;">return</span> (</a>
<a class="sourceLine" id="cb70-21" title="21" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-22" title="22" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            )<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb70-23" title="23" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb70-24" title="24" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb70-25" title="25" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb70-26" title="26" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb70-27" title="27" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">export</span> <span class="im">default</span> CountyMap<span class="op" style="color: #666666;">;</span></a></code></pre>
    </div>
    <p>
      Weâ€™ll set up default D3 state in
      <code style="white-space: pre-wrap;">constructor</code> and keep it up to
      date with
      <code style="white-space: pre-wrap;">getDerivedStateFromProps</code>.
    </p>
    <p>
      We need three D3 objects to build a choropleth map: a geographical
      projection, a path generator, and a quantize scale for colors.
    </p>
    <div
      class="sourceCode"
      id="cb71"
      data-caption="D3 objects for a map"
      style="overflow: visible; margin: 1em 0;"
    >
      <pre
        class="sourceCode javascript"
        style="overflow: visible; margin: 0;"
      ><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb71-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// src/components/CountyMap/CountyMap.js</span></a>
<a class="sourceLine" id="cb71-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="kw" style="color: #007020; font-weight: bold;">class</span> CountyMap <span class="kw" style="color: #007020; font-weight: bold;">extends</span> <span class="va" style="color: #19177c;">React</span>.<span class="at" style="color: #7d9029;">Component</span> <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb71-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="at" style="color: #7d9029;">constructor</span>(props) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb71-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">super</span>(props)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb71-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb71-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">const</span> projection <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">geoAlbersUsa</span>().<span class="at" style="color: #7d9029;">scale</span>(<span class="dv" style="color: #40a070;">1280</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb71-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb71-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">state</span> <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb71-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="dt" style="color: #902000;">geoPath</span><span class="op" style="color: #666666;">:</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">geoPath</span>().<span class="at" style="color: #7d9029;">projection</span>(projection)<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb71-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="dt" style="color: #902000;">quantize</span><span class="op" style="color: #666666;">:</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">scaleQuantize</span>().<span class="at" style="color: #7d9029;">range</span>(<span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">range</span>(<span class="dv" style="color: #40a070;">9</span>))<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb71-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            projection</a>
<a class="sourceLine" id="cb71-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">};</span></a>
<a class="sourceLine" id="cb71-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span></a></code></pre>
    </div>
    <p>
      You might remember geographical projections from high school. They map a
      sphere to a flat surface. We use
      <code style="white-space: pre-wrap;">geoAlbersUsa</code> because itâ€™s
      made specifically for maps of the USA.
    </p>
    <p>
      D3 offers many other projections. You can see them on
      <a href="https://github.com/d3/d3-geo#projections"
        >d3-geoâ€™s Github page</a
      >.
    </p>
    <p>
      A <code style="white-space: pre-wrap;">geoPath</code> generator takes a
      projection and returns a function that generates the
      <code style="white-space: pre-wrap;">d</code> attribute of
      <code style="white-space: pre-wrap;">&lt;path&gt;</code> elements. This
      is the most general way to specify SVG shapes. I wonâ€™t go into explaining
      the <code style="white-space: pre-wrap;">d</code> here, but itâ€™s
      <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d"
        >an entire language</a
      >
      for describing shapes.
    </p>
    <p>
      <code style="white-space: pre-wrap;">quantize</code> is a D3 scale. Weâ€™ve
      talked about the basics of scales in the
      <a
        href="https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887732#blackbox-axis"
        >D3 Axis example</a
      >. This one splits a domain into 9 quantiles and assigns them specific
      values from the <code style="white-space: pre-wrap;">range</code>.
    </p>
    <p>
      Letâ€™s say our domain goes from 0 to 90. Calling the scale with any number
      between 0 and 9 would return 1. 10 to 19 returns 2 and so on. Weâ€™ll use
      it to pick colors from an array.
    </p>
    <h3 id="getderivedstatefromprops">getDerivedStateFromProps</h3>
    <p>
      Keeping our geo path and quantize scale up to date is simple, but weâ€™ll
      make it harder by adding a zoom feature. It wonâ€™t work until we build the
      filtering, but hey, weâ€™ll already have it by then! ðŸ˜„
    </p>
    <div
      class="sourceCode"
      id="cb72"
      data-caption="CountyMap getDerivedStateFromProps"
      style="overflow: visible; margin: 1em 0;"
    >
      <pre
        class="sourceCode javascript"
        style="overflow: visible; margin: 0;"
      ><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb72-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="co" style="color: #60a0b0; font-style: italic;">// src/components/CountyMap/CountyMap.js</span></a>
<a class="sourceLine" id="cb72-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">static</span> <span class="at" style="color: #7d9029;">getDerivedStateFromProps</span>(props<span class="op" style="color: #666666;">,</span> state) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb72-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">let</span> <span class="op" style="color: #666666;">{</span> projection<span class="op" style="color: #666666;">,</span> quantize<span class="op" style="color: #666666;">,</span> geoPath <span class="op" style="color: #666666;">}</span> <span class="op" style="color: #666666;">=</span> state<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        projection</a>
<a class="sourceLine" id="cb72-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            .<span class="at" style="color: #7d9029;">translate</span>([<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">width</span> / <span class="dv" style="color: #40a070;">2</span><span class="op" style="color: #666666;">,</span> <span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">height</span> / <span class="dv" style="color: #40a070;">2</span>])</a>
<a class="sourceLine" id="cb72-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            .<span class="at" style="color: #7d9029;">scale</span>(<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">width</span> <span class="op" style="color: #666666;">*</span> <span class="fl" style="color: #40a070;">1.3</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="cf" style="color: #007020; font-weight: bold;">if</span> (<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">zoom</span> <span class="op" style="color: #666666;">&amp;&amp;</span> <span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">usTopoJson</span>) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb72-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="kw" style="color: #007020; font-weight: bold;">const</span> us <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">usTopoJson</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                USstatePaths <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">topojson</span>.<span class="at" style="color: #7d9029;">feature</span>(us<span class="op" style="color: #666666;">,</span> <span class="va" style="color: #19177c;">us</span>.<span class="va" style="color: #19177c;">objects</span>.<span class="at" style="color: #7d9029;">states</span>).<span class="at" style="color: #7d9029;">features</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                id <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">_</span>.<span class="at" style="color: #7d9029;">find</span>(<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">USstateNames</span><span class="op" style="color: #666666;">,</span> <span class="op" style="color: #666666;">{</span> <span class="dt" style="color: #902000;">code</span><span class="op" style="color: #666666;">:</span> <span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">zoom</span> <span class="op" style="color: #666666;">}</span>).<span class="at" style="color: #7d9029;">id</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="va" style="color: #19177c;">projection</span>.<span class="at" style="color: #7d9029;">scale</span>(<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">width</span> <span class="op" style="color: #666666;">*</span> <span class="fl" style="color: #40a070;">4.5</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-16" title="16" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="kw" style="color: #007020; font-weight: bold;">const</span> centroid <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">geoPath</span>.<span class="at" style="color: #7d9029;">centroid</span>(<span class="va" style="color: #19177c;">_</span>.<span class="at" style="color: #7d9029;">find</span>(USstatePaths<span class="op" style="color: #666666;">,</span> <span class="op" style="color: #666666;">{</span> <span class="dt" style="color: #902000;">id</span><span class="op" style="color: #666666;">:</span> id <span class="op" style="color: #666666;">}</span>))<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-17" title="17" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                translate <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">projection</span>.<span class="at" style="color: #7d9029;">translate</span>()<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-18" title="18" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-19" title="19" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="va" style="color: #19177c;">projection</span>.<span class="at" style="color: #7d9029;">translate</span>([</a>
<a class="sourceLine" id="cb72-20" title="20" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                translate[<span class="dv" style="color: #40a070;">0</span>] <span class="op" style="color: #666666;">-</span> centroid[<span class="dv" style="color: #40a070;">0</span>] <span class="op" style="color: #666666;">+</span> <span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">width</span> / <span class="dv" style="color: #40a070;">2</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-21" title="21" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                translate[<span class="dv" style="color: #40a070;">1</span>] <span class="op" style="color: #666666;">-</span> centroid[<span class="dv" style="color: #40a070;">1</span>] <span class="op" style="color: #666666;">+</span> <span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">height</span> / <span class="dv" style="color: #40a070;">2</span></a>
<a class="sourceLine" id="cb72-22" title="22" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            ])<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-23" title="23" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb72-24" title="24" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-25" title="25" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="cf" style="color: #007020; font-weight: bold;">if</span> (<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">values</span>) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb72-26" title="26" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="va" style="color: #19177c;">quantize</span>.<span class="at" style="color: #7d9029;">domain</span>([</a>
<a class="sourceLine" id="cb72-27" title="27" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">quantile</span>(<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">values</span><span class="op" style="color: #666666;">,</span> <span class="fl" style="color: #40a070;">0.15</span><span class="op" style="color: #666666;">,</span> d <span class="kw" style="color: #007020; font-weight: bold;">=&gt;</span> <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">value</span>)<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-28" title="28" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">quantile</span>(<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">values</span><span class="op" style="color: #666666;">,</span> <span class="fl" style="color: #40a070;">0.85</span><span class="op" style="color: #666666;">,</span> d <span class="kw" style="color: #007020; font-weight: bold;">=&gt;</span> <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">value</span>)</a>
<a class="sourceLine" id="cb72-29" title="29" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            ])<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb72-30" title="30" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb72-31" title="31" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb72-32" title="32" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb72-33" title="33" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            ...<span class="at" style="color: #7d9029;">state</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-34" title="34" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            projection<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb72-35" title="35" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            quantize</a>
<a class="sourceLine" id="cb72-36" title="36" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">};</span></a>
<a class="sourceLine" id="cb72-37" title="37" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span></a></code></pre>
    </div>
    <p>Thereâ€™s a lot going on here.</p>
    <p>
      We destructure <code style="white-space: pre-wrap;">projection</code>,
      <code style="white-space: pre-wrap;">quantize</code>, and
      <code style="white-space: pre-wrap;">geoPath</code> out of component
      state. These are the D3 object weâ€™re about to update.
    </p>
    <p>
      First up is the projection. We translate (move) it to the center of our
      drawing area and set the scale property. You have to play around with
      this value until you get a nice result because itâ€™s different for every
      projection.
    </p>
    <p>
      Then we do some weird stuff if
      <code style="white-space: pre-wrap;">zoom</code> is defined.
    </p>
    <p>
      We get the list of all US state features in our geo data, find the one
      weâ€™re <code style="white-space: pre-wrap;">zoom</code>-ing on, and use
      the <code style="white-space: pre-wrap;">geoPath.centroid</code> method
      to calculate its center point. This gives us a new coordinate to
      <code style="white-space: pre-wrap;">translate</code> our projection
      onto.
    </p>
    <p>
      The calculation in
      <code style="white-space: pre-wrap;">.translate()</code> helps us align
      the center point of our
      <code style="white-space: pre-wrap;">zoom</code> US state with the center
      of the drawing area.
    </p>
    <p>
      While all of this is going on, we also tweak the
      <code style="white-space: pre-wrap;">.scale</code> property to make the
      map bigger. This creates a zooming effect.
    </p>
    <p>
      After all that, we update the quantize scaleâ€™s domain with new values.
      Using <code style="white-space: pre-wrap;">d3.quantile</code> lets us
      offset the scale to produce a more interesting map. Again, I discovered
      these values through experiment - they cut off the top and bottom of the
      range because there isnâ€™t much there. This brings higher contrast to the
      richer middle of the range.
    </p>
    <p>
      With our D3 objects updated, we return a new derived state.
      <em>Technically</em> you donâ€™t have to do this but you should. Due to how
      JavaScript works, you already updated D3 objects in place, but you should
      pretend <code style="white-space: pre-wrap;">this.state</code> is
      immutable and return a new copy.
    </p>
    <p>
      Overall that makes your code easier to understand and closer to React
      principles.
    </p>
    <h3 id="render">render</h3>
    <p>
      After all that hard work, the
      <code style="white-space: pre-wrap;">render</code> method is a breeze. We
      prep our data then loop through it and render a
      <code style="white-space: pre-wrap;">County</code> element for each
      entry.
    </p>
    <div
      class="sourceCode"
      id="cb73"
      data-caption="CountyMap render"
      style="overflow: visible; margin: 1em 0;"
    >
      <pre
        class="sourceCode javascript"
        style="overflow: visible; margin: 0;"
      ><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb73-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="at" style="color: #7d9029;">render</span>() <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb73-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="kw" style="color: #007020; font-weight: bold;">const</span> <span class="op" style="color: #666666;">{</span> geoPath<span class="op" style="color: #666666;">,</span> quantize <span class="op" style="color: #666666;">}</span> <span class="op" style="color: #666666;">=</span> <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">state</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb73-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="op" style="color: #666666;">{</span> usTopoJson<span class="op" style="color: #666666;">,</span> values<span class="op" style="color: #666666;">,</span> zoom <span class="op" style="color: #666666;">}</span> <span class="op" style="color: #666666;">=</span> <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">props</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb73-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb73-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="cf" style="color: #007020; font-weight: bold;">if</span> (<span class="op" style="color: #666666;">!</span>usTopoJson) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb73-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="kw" style="color: #007020; font-weight: bold;">null</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb73-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span> <span class="cf" style="color: #007020; font-weight: bold;">else</span> <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb73-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="kw" style="color: #007020; font-weight: bold;">const</span> us <span class="op" style="color: #666666;">=</span> usTopoJson<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb73-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                USstatesMesh <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">topojson</span>.<span class="at" style="color: #7d9029;">mesh</span>(</a>
<a class="sourceLine" id="cb73-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    us<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb73-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    <span class="va" style="color: #19177c;">us</span>.<span class="va" style="color: #19177c;">objects</span>.<span class="at" style="color: #7d9029;">states</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb73-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    (a<span class="op" style="color: #666666;">,</span> b) <span class="kw" style="color: #007020; font-weight: bold;">=&gt;</span> a <span class="op" style="color: #666666;">!==</span> b</a>
<a class="sourceLine" id="cb73-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                )<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb73-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                counties <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">topojson</span>.<span class="at" style="color: #7d9029;">feature</span>(us<span class="op" style="color: #666666;">,</span> <span class="va" style="color: #19177c;">us</span>.<span class="va" style="color: #19177c;">objects</span>.<span class="at" style="color: #7d9029;">counties</span>).<span class="at" style="color: #7d9029;">features</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb73-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb73-16" title="16" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="kw" style="color: #007020; font-weight: bold;">const</span> countyValueMap <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">_</span>.<span class="at" style="color: #7d9029;">fromPairs</span>(</a>
<a class="sourceLine" id="cb73-17" title="17" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                <span class="va" style="color: #19177c;">values</span>.<span class="at" style="color: #7d9029;">map</span>(d <span class="kw" style="color: #007020; font-weight: bold;">=&gt;</span> [<span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">countyID</span><span class="op" style="color: #666666;">,</span> <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">value</span>])</a>
<a class="sourceLine" id="cb73-18" title="18" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            )<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb73-19" title="19" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb73-20" title="20" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            <span class="cf" style="color: #007020; font-weight: bold;">return</span> (</a>
<a class="sourceLine" id="cb73-21" title="21" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                <span class="op" style="color: #666666;">&lt;</span>g<span class="op" style="color: #666666;">&gt;</span></a>
<a class="sourceLine" id="cb73-22" title="22" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    <span class="op" style="color: #666666;">{</span><span class="va" style="color: #19177c;">counties</span>.<span class="at" style="color: #7d9029;">map</span>(feature <span class="kw" style="color: #007020; font-weight: bold;">=&gt;</span> (</a>
<a class="sourceLine" id="cb73-23" title="23" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                        <span class="op" style="color: #666666;">&lt;</span>County</a>
<a class="sourceLine" id="cb73-24" title="24" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                            geoPath<span class="op" style="color: #666666;">={</span>geoPath<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-25" title="25" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                            feature<span class="op" style="color: #666666;">={</span>feature<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-26" title="26" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                            zoom<span class="op" style="color: #666666;">={</span>zoom<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-27" title="27" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                            key<span class="op" style="color: #666666;">={</span><span class="va" style="color: #19177c;">feature</span>.<span class="at" style="color: #7d9029;">id</span><span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-28" title="28" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                            quantize<span class="op" style="color: #666666;">={</span>quantize<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-29" title="29" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                            value<span class="op" style="color: #666666;">={</span>countyValueMap[<span class="va" style="color: #19177c;">feature</span>.<span class="at" style="color: #7d9029;">id</span>]<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-30" title="30" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                        /&gt;</a>
<a class="sourceLine" id="cb73-31" title="31" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    ))<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-32" title="32" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb73-33" title="33" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    <span class="op" style="color: #666666;">&lt;</span>path</a>
<a class="sourceLine" id="cb73-34" title="34" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                        d<span class="op" style="color: #666666;">={</span><span class="at" style="color: #7d9029;">geoPath</span>(USstatesMesh)<span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-35" title="35" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                        style<span class="op" style="color: #666666;">={{</span></a>
<a class="sourceLine" id="cb73-36" title="36">                            <span class="dt">fill</span><span class="op">:</span> <span class="st">&quot;none&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb73-37" title="37">                            <span class="dt">stroke</span><span class="op">:</span> <span class="st">&quot;#fff&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb73-38" title="38">                            <span class="dt">strokeLinejoin</span><span class="op">:</span> <span class="st">&quot;round&quot;</span></a>
<a class="sourceLine" id="cb73-39" title="39">                        <span class="op">}}</span></a>
<a class="sourceLine" id="cb73-40" title="40" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    /&gt;</a>
<a class="sourceLine" id="cb73-41" title="41" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                &lt;/g<span class="op" style="color: #666666;">&gt;</span></a>
<a class="sourceLine" id="cb73-42" title="42" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">            )<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb73-43" title="43" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb73-44" title="44" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span></a></code></pre>
    </div>
    <p>
      We use destructuring to save all relevant props and state in constants,
      then use the TopoJSON library to grab data out of the
      <code style="white-space: pre-wrap;">usTopoJson</code> dataset.
    </p>
    <p>
      <code style="white-space: pre-wrap;">.mesh</code> calculates a mesh for
      US states â€“Â a thin line around the edges.
      <code style="white-space: pre-wrap;">.feature</code> calculates feature
      for each count â€“Â fill in with color.
    </p>
    <p>
      Mesh and feature arenâ€™t tied to US states or counties by the way. Itâ€™s
      just a matter of what you get back: borders or flat areas. What you need
      depends on what youâ€™re building.
    </p>
    <p>
      We use Lodashâ€™s
      <code style="white-space: pre-wrap;">_.fromPairs</code> to build a
      dictionary that maps county identifiers to their values. Building it
      beforehand makes our code faster. You can read some details about the
      speed optimizations
      <a
        href="https://swizec.com/blog/optimizing-react-choropleth-map-rendering/swizec/7302"
        >here</a
      >.
    </p>
    <p>
      As promised, the
      <code style="white-space: pre-wrap;">return</code> statement loops
      through the list of
      <code style="white-space: pre-wrap;">counties</code> and renders
      <code style="white-space: pre-wrap;">County</code> components. Each gets
      a bunch of attributes and returns a
      <code style="white-space: pre-wrap;">&lt;path&gt;</code> element that
      looks like a specific county.
    </p>
    <p>
      For US state borders, we render a single
      <code style="white-space: pre-wrap;">&lt;path&gt;</code> element and use
      <code style="white-space: pre-wrap;">geoPath</code> to generate the
      <code style="white-space: pre-wrap;">d</code> attribute.
    </p>