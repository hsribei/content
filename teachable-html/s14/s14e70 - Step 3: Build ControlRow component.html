<h2 id="step-3-build-controlrow-component">Step 3: Build ControlRow component</h2>
<p>Let’s build the <code>ControlRow</code> component. It renders a row of controls and ensures only one at a time is selected.</p>
<p>We’ll start with a stub and go from there.</p>
<div class="sourceCode" id="cb108" data-caption="ControlRow stub"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb108-1" title="1"><span class="co">// src/components/Controls/ControlRow.js</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="im">import</span> React <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb108-3" title="3"></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="im">import</span> Toggle <span class="im">from</span> <span class="st">&quot;./Toggle&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb108-5" title="5"></a>
<a class="sourceLine" id="cb108-6" title="6"><span class="kw">class</span> ControlRow <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb108-7" title="7">    makePick <span class="op">=</span> (picked<span class="op">,</span> newState) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb108-8" title="8"> </a>
<a class="sourceLine" id="cb108-9" title="9">    <span class="op">};</span></a>
<a class="sourceLine" id="cb108-10" title="10"></a>
<a class="sourceLine" id="cb108-11" title="11">    <span class="at">_addToggle</span>(name) <span class="op">{</span></a>
<a class="sourceLine" id="cb108-12" title="12">    <span class="op">}</span></a>
<a class="sourceLine" id="cb108-13" title="13"></a>
<a class="sourceLine" id="cb108-14" title="14">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb108-15" title="15">        <span class="kw">const</span> <span class="op">{</span> toggleNames <span class="op">}</span> <span class="op">=</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">;</span></a>
<a class="sourceLine" id="cb108-16" title="16">    <span class="op">}</span></a>
<a class="sourceLine" id="cb108-17" title="17"><span class="op">}</span></a>
<a class="sourceLine" id="cb108-18" title="18"></a>
<a class="sourceLine" id="cb108-19" title="19"><span class="im">export</span> <span class="im">default</span> ControlRow<span class="op">;</span></a></code></pre></div>
<p>We start with imports, big surprise, then make a stub with 3 methods. Can you guess what they are?</p>
<ul>
<li><code>makePick</code> is the <code>Toggle</code> click callback</li>
<li><code>_addToggle</code> is a rendering helper method</li>
<li><code>render</code> renders a row of buttons</li>
</ul>
<div class="sourceCode" id="cb109" data-caption="makePick implementation"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb109-1" title="1"><span class="co">// src/components/Controls/ControlRow.js</span></a>
<a class="sourceLine" id="cb109-2" title="2"></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="kw">class</span> ControlRow <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb109-4" title="4">    makePick <span class="op">=</span> (picked<span class="op">,</span> newState) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb109-5" title="5">        <span class="co">// if newState is false, we want to reset</span></a>
<a class="sourceLine" id="cb109-6" title="6">        <span class="kw">this</span>.<span class="va">props</span>.<span class="at">updateDataFilter</span>(picked<span class="op">,</span> <span class="op">!</span>newState)<span class="op">;</span></a>
<a class="sourceLine" id="cb109-7" title="7">    <span class="op">};</span></a></code></pre></div>
<p><code>makePick</code> calls the data filter update and passes in the new value and whether we want to unselect. Pretty simple right?</p>
<div class="sourceCode" id="cb110" data-caption="Render a row of controls"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb110-1" title="1"><span class="co">// src/components/Controls/ControlRow.js</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="kw">class</span> ControlRow <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb110-3" title="3">    <span class="co">// ...</span></a>
<a class="sourceLine" id="cb110-4" title="4"></a>
<a class="sourceLine" id="cb110-5" title="5">    <span class="at">_addToggle</span>(name) <span class="op">{</span></a>
<a class="sourceLine" id="cb110-6" title="6">        <span class="kw">let</span> key <span class="op">=</span> <span class="vs">`toggle-</span><span class="sc">${</span>name<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb110-7" title="7">            label <span class="op">=</span> name<span class="op">;</span></a>
<a class="sourceLine" id="cb110-8" title="8"></a>
<a class="sourceLine" id="cb110-9" title="9">        <span class="cf">if</span> (<span class="kw">this</span>.<span class="va">props</span>.<span class="at">capitalize</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb110-10" title="10">            label <span class="op">=</span> <span class="va">label</span>.<span class="at">toUpperCase</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb110-11" title="11">        <span class="op">}</span></a>
<a class="sourceLine" id="cb110-12" title="12"></a>
<a class="sourceLine" id="cb110-13" title="13">        <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb110-14" title="14">            <span class="op">&lt;</span>Toggle</a>
<a class="sourceLine" id="cb110-15" title="15">                label<span class="op">={</span>label<span class="op">}</span></a>
<a class="sourceLine" id="cb110-16" title="16">                name<span class="op">={</span>name<span class="op">}</span></a>
<a class="sourceLine" id="cb110-17" title="17">                key<span class="op">={</span>key<span class="op">}</span></a>
<a class="sourceLine" id="cb110-18" title="18">                value<span class="op">={</span><span class="kw">this</span>.<span class="va">props</span>.<span class="at">picked</span> <span class="op">===</span> name<span class="op">}</span></a>
<a class="sourceLine" id="cb110-19" title="19">                onClick<span class="op">={</span><span class="kw">this</span>.<span class="at">makePick</span><span class="op">}</span></a>
<a class="sourceLine" id="cb110-20" title="20">            /&gt;</a>
<a class="sourceLine" id="cb110-21" title="21">        )<span class="op">;</span></a>
<a class="sourceLine" id="cb110-22" title="22">    <span class="op">}</span></a>
<a class="sourceLine" id="cb110-23" title="23"></a>
<a class="sourceLine" id="cb110-24" title="24">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb110-25" title="25">        <span class="kw">const</span> <span class="op">{</span> toggleNames <span class="op">}</span> <span class="op">=</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">;</span></a>
<a class="sourceLine" id="cb110-26" title="26"></a>
<a class="sourceLine" id="cb110-27" title="27">        <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb110-28" title="28">            <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;row&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb110-29" title="29">                <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;col-md-12&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb110-30" title="30">                    <span class="op">{</span><span class="va">toggleNames</span>.<span class="at">map</span>(name <span class="op">=&gt;</span> <span class="kw">this</span>.<span class="at">_addToggle</span>(name))<span class="op">}</span></a>
<a class="sourceLine" id="cb110-31" title="31">                &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb110-32" title="32">            &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb110-33" title="33">        )<span class="op">;</span></a>
<a class="sourceLine" id="cb110-34" title="34">    <span class="op">}</span></a>
<a class="sourceLine" id="cb110-35" title="35"><span class="op">}</span></a></code></pre></div>
<p>Rendering comes in two functions: <code>_addToggle</code>, which is a helper, and <code>render</code>, which is the main render.</p>
<p>In <code>render</code>, we set up two <code>div</code>s with Bootstrap classes. The first is a <code>row</code>, and the second is a full-width column. I tried using a column for each button, but it was annoying to manage and used too much space.</p>
<p>Inside the divs, we map over all toggles and use <code>_addToggle</code> to render each of them.</p>
<p><code>_addToggle</code> renders a <code>Toggle</code> component with a <code>label</code>, <code>name</code>, <code>value</code> and <code>onClick</code> callback. The label is just a prettier version of the name, which also serves as a key in our <code>toggleValues</code> dictionary. It’s going to be the <code>picked</code> attribute in <code>makePick</code>.</p>
<p>Your browser should continue showing an error, but it should change to talking about the <code>Toggle</code> component instead of <code>ControlRow</code>.</p>
<p><img src="https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/toggle-error.png" /></p>
<p>Let’s build it.</p>