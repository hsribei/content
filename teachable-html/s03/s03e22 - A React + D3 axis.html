<h2 id="a-quick-blackbox-example---a-reactd3-axis">A quick blackbox example - a React+D3 axis</h2>
<p>Now letâ€™s say we want to use that same axis code but as a React component. The simplest way is to use a blackbox component approach like this:</p>
<div class="sourceCode" id="cb22" data-caption="React blackbox axis" style="overflow: visible; margin: 1em 0;"><pre class="sourceCode javascript" style="overflow: visible; margin: 0;"><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb22-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="kw" style="color: #007020; font-weight: bold;">class</span> Axis <span class="kw" style="color: #007020; font-weight: bold;">extends</span> Component <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb22-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  gRef <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">React</span>.<span class="at" style="color: #7d9029;">createRef</span>()<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb22-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb22-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="at" style="color: #7d9029;">componentDidMount</span>() <span class="op" style="color: #666666;">{</span> <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">d3render</span>() <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb22-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="at" style="color: #7d9029;">componentDidUpdate</span>() <span class="op" style="color: #666666;">{</span> <span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">d3render</span>() <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb22-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb22-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="at" style="color: #7d9029;">d3render</span>() <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb22-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">const</span> scale <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">scaleLinear</span>()</a>
<a class="sourceLine" id="cb22-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    .<span class="at" style="color: #7d9029;">domain</span>([<span class="dv" style="color: #40a070;">0</span><span class="op" style="color: #666666;">,</span> <span class="dv" style="color: #40a070;">10</span>])</a>
<a class="sourceLine" id="cb22-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">                    .<span class="at" style="color: #7d9029;">range</span>([<span class="dv" style="color: #40a070;">0</span><span class="op" style="color: #666666;">,</span> <span class="dv" style="color: #40a070;">200</span>])<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb22-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="kw" style="color: #007020; font-weight: bold;">const</span> axis <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">axisBottom</span>(scale)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb22-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb22-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">select</span>(<span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">gRef</span>)</a>
<a class="sourceLine" id="cb22-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      .<span class="at" style="color: #7d9029;">call</span>(axis)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb22-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb22-16" title="16" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb22-17" title="17" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="at" style="color: #7d9029;">render</span>() <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb22-18" title="18" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="op" style="color: #666666;">&lt;</span>g transform<span class="op" style="color: #666666;">=</span><span class="st" style="color: #4070a0;">&quot;translate(10, 30)&quot;</span> ref<span class="op" style="color: #666666;">={</span><span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="at" style="color: #7d9029;">gRef</span><span class="op" style="color: #666666;">}</span> /&gt;</a>
<a class="sourceLine" id="cb22-19" title="19" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="op" style="color: #666666;">}</span></a>
<a class="sourceLine" id="cb22-20" title="20" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="op" style="color: #666666;">}</span></a></code></pre></div>
<p>So much code! Worth it for the other benefits of using React in your dataviz. Youâ€™ll see <span class="emoji" data-emoji="smiley">ðŸ˜ƒ</span></p>
<p>We created an <code style="white-space: pre-wrap;">Axis</code> component that extends Reactâ€™s base <code style="white-space: pre-wrap;">Component</code> class. We canâ€™t use functional components because we need lifecycle hooks.</p>
<p>Our component has a <code style="white-space: pre-wrap;">render</code> method. It returns a grouping element (<code style="white-space: pre-wrap;">g</code>) moved 10px to the right and 30px down using the <code style="white-space: pre-wrap;">transform</code> attribute. Same as before.</p>
<p>A React ref saved in <code style="white-space: pre-wrap;">this.gRef</code> and passed into our <code style="white-space: pre-wrap;">&lt;g&gt;</code> element with <code style="white-space: pre-wrap;">ref</code> lets us talk to the DOM node directly. We need this to hand over rendering control to D3.</p>
<p>The <code style="white-space: pre-wrap;">d3render</code> method looks familiar. Itâ€™s the same code we used in the vanilla D3 example. Scale, axis, select, call. Only difference is that instead of selecting <code style="white-space: pre-wrap;">svg</code> and appending a <code style="white-space: pre-wrap;">g</code> element, we select the <code style="white-space: pre-wrap;">g</code> element rendered by React and use that.</p>
<p>We use <code style="white-space: pre-wrap;">componentDidUpdate</code> and <code style="white-space: pre-wrap;">componentDidMount</code> to keep our render up to date. Ensures that our axis re-renders every time Reactâ€™s engine decides to render our component.</p>
<p>That wasnâ€™t so bad, was it?</p>
<p><a href="https://codesandbox.io/s/3xy2jr1y5m">Try it out on Codesandbox</a>.</p>
<iframe src="https://codesandbox.io/embed/3xy2jr1y5m?codemirror=1&amp;view=split" style="width:100%; height:500px; border:open_mouth:; border-radius: 4px; overflow:hidden;" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin">
</iframe>
<p>You can make the axis more useful by getting positioning, scale, and orientation from props. Weâ€™ll do that in our big project.</p>
<h3 id="practical-exercise">Practical exercise</h3>
<p>Try implementing those as an exercise. Make the axis more reusable with some carefully placed props.</p>
<p>Hereâ€™s my solution, if you get stuck <span class="emoji" data-emoji="point_right">ðŸ‘‰</span> <a href="https://codesandbox.io/s/5ywlj6jn4l">https://codesandbox.io/s/5ywlj6jn4l</a></p>
<iframe src="https://codesandbox.io/embed/5ywlj6jn4l?codemirror=1&amp;view=split" style="width:100%; height:500px; border:open_mouth:; border-radius: 4px; overflow:hidden;" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin">
</iframe>