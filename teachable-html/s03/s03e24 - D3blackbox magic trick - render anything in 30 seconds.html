<h2 id="magic-trick">D3blackbox magic trick – render anything in 30 seconds</h2>
<p>Let me show you a magic trick. 30 seconds to take a random D3 piece of code and add it to your React project.</p>
<p>We can try it on the example barchart from before.</p>
<figure>
<img src="https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/barchart-example.png" alt="An example D3 barchart"><figcaption>An example D3 barchart</figcaption>
</figure>
<p>You can <a href="https://cdn.rawgit.com/mbostock/3885304/raw/a91f37f5f4b43269df3dbabcda0090310c05285d/index.html">try it online</a>. When you hover on a bar, it changes color. Pretty neat.</p>
<p>I recommend you follow along in a CodeSandbox. If you fork the <a href="https://codesandbox.io/s/5v21r0wo4x">react-d3-axis-hoc CodeSandbox</a> that will be easiest.</p>
<iframe src="https://codesandbox.io/embed/5v21r0wo4x?codemirror=1&amp;view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin">
</iframe>
<p>You should already have the <code style="white-space: pre-wrap;">D3blackbox</code> HOC. If you don’t, make a new file and paste it in.</p>
<p>With your HOC ready, create a new file in CodeSandbox. Call it <code style="white-space: pre-wrap;">Barchart.js</code>.</p>
<p>Add your imports:</p>
<div class="sourceCode" id="cb25" data-caption="Import dependencies" style="overflow: visible; margin: 1em 0;"><pre class="sourceCode javascript" style="overflow: visible; margin: 0;"><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb25-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> React <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;react&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb25-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> D3blackbox <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;./D3blackbox&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb25-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> <span class="op" style="color: #666666;">*</span> <span class="im">as</span> d3 <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;d3&#39;</span><span class="op" style="color: #666666;">;</span></a></code></pre></div>
<p>This gives you React, our HOC, and D3.</p>
<p>Now right-click view code on that barchart and copy the code. Wrap it in a <code style="white-space: pre-wrap;">D3blackbox</code> call. Like this:</p>
<div class="sourceCode" id="cb26" data-caption="Wrap D3 code in D3blackbox" style="overflow: visible; margin: 1em 0;"><pre class="sourceCode javascript" style="overflow: visible; margin: 0;"><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb26-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="kw" style="color: #007020; font-weight: bold;">const</span> Barchart <span class="op" style="color: #666666;">=</span> <span class="at" style="color: #7d9029;">D3blackbox</span>(<span class="kw" style="color: #007020; font-weight: bold;">function</span> () <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb26-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">var</span> svg <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">select</span>(<span class="st" style="color: #4070a0;">&quot;svg&quot;</span>)<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb26-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        margin <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">{</span><span class="dt" style="color: #902000;">top</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">20</span><span class="op" style="color: #666666;">,</span> <span class="dt" style="color: #902000;">right</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">20</span><span class="op" style="color: #666666;">,</span> <span class="dt" style="color: #902000;">bottom</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">30</span><span class="op" style="color: #666666;">,</span> <span class="dt" style="color: #902000;">left</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">40</span><span class="op" style="color: #666666;">},</span></a>
<a class="sourceLine" id="cb26-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        width <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="va" style="color: #19177c;">svg</span>.<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;width&quot;</span>) <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">left</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">right</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb26-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        height <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="va" style="color: #19177c;">svg</span>.<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;height&quot;</span>) <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">top</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">bottom</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">var</span> x <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">scaleBand</span>().<span class="at" style="color: #7d9029;">rangeRound</span>([<span class="dv" style="color: #40a070;">0</span><span class="op" style="color: #666666;">,</span> width]).<span class="at" style="color: #7d9029;">padding</span>(<span class="fl" style="color: #40a070;">0.1</span>)<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb26-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        y <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">scaleLinear</span>().<span class="at" style="color: #7d9029;">rangeRound</span>([height<span class="op" style="color: #666666;">,</span> <span class="dv" style="color: #40a070;">0</span>])<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">var</span> g <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">svg</span>.<span class="at" style="color: #7d9029;">append</span>(<span class="st" style="color: #4070a0;">&quot;g&quot;</span>)</a>
<a class="sourceLine" id="cb26-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;transform&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;translate(&quot;</span> <span class="op" style="color: #666666;">+</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">left</span> <span class="op" style="color: #666666;">+</span> <span class="st" style="color: #4070a0;">&quot;,&quot;</span> <span class="op" style="color: #666666;">+</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">top</span> <span class="op" style="color: #666666;">+</span> <span class="st" style="color: #4070a0;">&quot;)&quot;</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">tsv</span>(<span class="st" style="color: #4070a0;">&quot;data.tsv&quot;</span><span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb26-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span> <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="cf" style="color: #007020; font-weight: bold;">return</span> d<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-16" title="16" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">},</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(error<span class="op" style="color: #666666;">,</span> data) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb26-17" title="17" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="cf" style="color: #007020; font-weight: bold;">if</span> (error) <span class="cf" style="color: #007020; font-weight: bold;">throw</span> error<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-18" title="18" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-19" title="19" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">x</span>.<span class="at" style="color: #7d9029;">domain</span>(<span class="va" style="color: #19177c;">data</span>.<span class="at" style="color: #7d9029;">map</span>(<span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span> <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">letter</span><span class="op" style="color: #666666;">;</span> <span class="op" style="color: #666666;">}</span>))<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-20" title="20" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">y</span>.<span class="at" style="color: #7d9029;">domain</span>([<span class="dv" style="color: #40a070;">0</span><span class="op" style="color: #666666;">,</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">max</span>(data<span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span> <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span><span class="op" style="color: #666666;">;</span> <span class="op" style="color: #666666;">}</span>)])<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-21" title="21" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-22" title="22" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">g</span>.<span class="at" style="color: #7d9029;">append</span>(<span class="st" style="color: #4070a0;">&quot;g&quot;</span>)</a>
<a class="sourceLine" id="cb26-23" title="23" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;class&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;axis axis--x&quot;</span>)</a>
<a class="sourceLine" id="cb26-24" title="24" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;transform&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;translate(0,&quot;</span> <span class="op" style="color: #666666;">+</span> height <span class="op" style="color: #666666;">+</span> <span class="st" style="color: #4070a0;">&quot;)&quot;</span>)</a>
<a class="sourceLine" id="cb26-25" title="25" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">call</span>(<span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">axisBottom</span>(x))<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-26" title="26" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-27" title="27" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">g</span>.<span class="at" style="color: #7d9029;">append</span>(<span class="st" style="color: #4070a0;">&quot;g&quot;</span>)</a>
<a class="sourceLine" id="cb26-28" title="28" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;class&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;axis axis--y&quot;</span>)</a>
<a class="sourceLine" id="cb26-29" title="29" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">call</span>(<span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">axisLeft</span>(y).<span class="at" style="color: #7d9029;">ticks</span>(<span class="dv" style="color: #40a070;">10</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;%&quot;</span>))</a>
<a class="sourceLine" id="cb26-30" title="30" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        .<span class="at" style="color: #7d9029;">append</span>(<span class="st" style="color: #4070a0;">&quot;text&quot;</span>)</a>
<a class="sourceLine" id="cb26-31" title="31" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;transform&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;rotate(-90)&quot;</span>)</a>
<a class="sourceLine" id="cb26-32" title="32" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;y&quot;</span><span class="op" style="color: #666666;">,</span> <span class="dv" style="color: #40a070;">6</span>)</a>
<a class="sourceLine" id="cb26-33" title="33" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;dy&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;0.71em&quot;</span>)</a>
<a class="sourceLine" id="cb26-34" title="34" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;text-anchor&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;end&quot;</span>)</a>
<a class="sourceLine" id="cb26-35" title="35" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">text</span>(<span class="st" style="color: #4070a0;">&quot;Frequency&quot;</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-36" title="36" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    </a>
<a class="sourceLine" id="cb26-37" title="37" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">g</span>.<span class="at" style="color: #7d9029;">selectAll</span>(<span class="st" style="color: #4070a0;">&quot;.bar&quot;</span>)</a>
<a class="sourceLine" id="cb26-38" title="38" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        .<span class="at" style="color: #7d9029;">data</span>(data)</a>
<a class="sourceLine" id="cb26-39" title="39" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        .<span class="at" style="color: #7d9029;">enter</span>().<span class="at" style="color: #7d9029;">append</span>(<span class="st" style="color: #4070a0;">&quot;rect&quot;</span>)</a>
<a class="sourceLine" id="cb26-40" title="40" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;class&quot;</span><span class="op" style="color: #666666;">,</span> <span class="st" style="color: #4070a0;">&quot;bar&quot;</span>)</a>
<a class="sourceLine" id="cb26-41" title="41" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;x&quot;</span><span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span> <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="at" style="color: #7d9029;">x</span>(<span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">letter</span>)<span class="op" style="color: #666666;">;</span> <span class="op" style="color: #666666;">}</span>)</a>
<a class="sourceLine" id="cb26-42" title="42" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;y&quot;</span><span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span> <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="at" style="color: #7d9029;">y</span>(<span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span>)<span class="op" style="color: #666666;">;</span> <span class="op" style="color: #666666;">}</span>)</a>
<a class="sourceLine" id="cb26-43" title="43" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;width&quot;</span><span class="op" style="color: #666666;">,</span> <span class="va" style="color: #19177c;">x</span>.<span class="at" style="color: #7d9029;">bandwidth</span>())</a>
<a class="sourceLine" id="cb26-44" title="44" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">          .<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;height&quot;</span><span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span> <span class="cf" style="color: #007020; font-weight: bold;">return</span> height <span class="op" style="color: #666666;">-</span> <span class="at" style="color: #7d9029;">y</span>(<span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span>)<span class="op" style="color: #666666;">;</span> <span class="op" style="color: #666666;">}</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-45" title="45" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span>)<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb26-46" title="46" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="op" style="color: #666666;">}</span>)</a>
<a class="sourceLine" id="cb26-47" title="47" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb26-48" title="48" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">export</span> <span class="im">default</span> Barchart<span class="op" style="color: #666666;">;</span></a></code></pre></div>
<p>That should throw some errors. We have to change the <code style="white-space: pre-wrap;">d3.select</code> and get <code style="white-space: pre-wrap;">width</code> and <code style="white-space: pre-wrap;">height</code> from props.</p>
<div class="sourceCode" id="cb27" data-caption="Change where D3 renders" style="overflow: visible; margin: 1em 0;"><pre class="sourceCode javascript" style="overflow: visible; margin: 0;"><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb27-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="kw" style="color: #007020; font-weight: bold;">const</span> Barchart <span class="op" style="color: #666666;">=</span> <span class="at" style="color: #7d9029;">D3blackbox</span>(<span class="kw" style="color: #007020; font-weight: bold;">function</span> () <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb27-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-delete</span></a>
<a class="sourceLine" id="cb27-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="kw" style="color: #007020; font-weight: bold;">var</span> svg <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">select</span>(<span class="st" style="color: #4070a0;">&quot;svg&quot;</span>)<span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb27-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-delete</span></a>
<a class="sourceLine" id="cb27-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-insert</span></a>
<a class="sourceLine" id="cb27-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="kw" style="color: #007020; font-weight: bold;">var</span> svg <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">select</span>(<span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="va" style="color: #19177c;">anchor</span>.<span class="at" style="color: #7d9029;">current</span>)</a>
<a class="sourceLine" id="cb27-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">  <span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-insert</span></a>
<a class="sourceLine" id="cb27-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        margin <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">{</span><span class="dt" style="color: #902000;">top</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">20</span><span class="op" style="color: #666666;">,</span> <span class="dt" style="color: #902000;">right</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">20</span><span class="op" style="color: #666666;">,</span> <span class="dt" style="color: #902000;">bottom</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">30</span><span class="op" style="color: #666666;">,</span> <span class="dt" style="color: #902000;">left</span><span class="op" style="color: #666666;">:</span> <span class="dv" style="color: #40a070;">40</span><span class="op" style="color: #666666;">},</span></a>
<a class="sourceLine" id="cb27-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-delete</span></a>
<a class="sourceLine" id="cb27-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        width <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="va" style="color: #19177c;">svg</span>.<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;width&quot;</span>) <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">left</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">right</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb27-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        height <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="va" style="color: #19177c;">svg</span>.<span class="at" style="color: #7d9029;">attr</span>(<span class="st" style="color: #4070a0;">&quot;height&quot;</span>) <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">top</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">bottom</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb27-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-delete</span></a>
<a class="sourceLine" id="cb27-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-insert</span></a>
<a class="sourceLine" id="cb27-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        width <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">width</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">left</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">right</span><span class="op" style="color: #666666;">,</span></a>
<a class="sourceLine" id="cb27-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        height <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="kw" style="color: #007020; font-weight: bold;">this</span>.<span class="va" style="color: #19177c;">props</span>.<span class="at" style="color: #7d9029;">height</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">top</span> <span class="op" style="color: #666666;">-</span> <span class="va" style="color: #19177c;">margin</span>.<span class="at" style="color: #7d9029;">bottom</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb27-16" title="16" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-insert</span></a></code></pre></div>
<p>Most D3 examples use a global <code style="white-space: pre-wrap;">svg</code> variable to refer to their drawing area – the SVG. Change that to the element you want, your anchor, and the whole visualization should render in there.</p>
<p>We also replaced reading width and height from the SVG element to getting them from props. This makes our component more reusable and better follows best practices.</p>
<p>Next step is to change where our barchart gets its data. Gotta use the public URL.</p>
<div class="sourceCode" id="cb28" data-caption="Change data URL" style="overflow: visible; margin: 1em 0;"><pre class="sourceCode javascript" style="overflow: visible; margin: 0;"><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb28-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">//markua-start-delete</span></a>
<a class="sourceLine" id="cb28-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">tsv</span>(<span class="st" style="color: #4070a0;">&quot;data.tsv&quot;</span><span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb28-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-delete</span></a>
<a class="sourceLine" id="cb28-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-insert</span></a>
<a class="sourceLine" id="cb28-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="va" style="color: #19177c;">d3</span>.<span class="at" style="color: #7d9029;">tsv</span>(<span class="st" style="color: #4070a0;">&quot;https://cdn.rawgit.com/mbostock/3885304/raw/a91f37f5f4b43269df3dbabcda0090310c05285d/data.tsv&quot;</span><span class="op" style="color: #666666;">,</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(d) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb28-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-insert</span></a>
<a class="sourceLine" id="cb28-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span> <span class="op" style="color: #666666;">=</span> <span class="op" style="color: #666666;">+</span><span class="va" style="color: #19177c;">d</span>.<span class="at" style="color: #7d9029;">frequency</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb28-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="cf" style="color: #007020; font-weight: bold;">return</span> d<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb28-9" title="9" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-delete</span></a>
<a class="sourceLine" id="cb28-10" title="10" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">},</span> <span class="kw" style="color: #007020; font-weight: bold;">function</span>(error<span class="op" style="color: #666666;">,</span> data) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb28-11" title="11" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">      <span class="cf" style="color: #007020; font-weight: bold;">if</span> (error) <span class="cf" style="color: #007020; font-weight: bold;">throw</span> error<span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb28-12" title="12" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-delete</span></a>
<a class="sourceLine" id="cb28-13" title="13" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-start-insert</span></a>
<a class="sourceLine" id="cb28-14" title="14" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">}</span>).<span class="at" style="color: #7d9029;">then</span>(<span class="kw" style="color: #007020; font-weight: bold;">function</span>(data) <span class="op" style="color: #666666;">{</span></a>
<a class="sourceLine" id="cb28-15" title="15" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// markua-end-insert</span></a></code></pre></div>
<p>Same link, absolute version. And we updated the callback-based code to use the D3v5 promises version. That’s the most disruptive change going from v4 to v5 I believe.</p>
<p>That’s it. You now have a Barchart component that renders the example barchart from D3’s docs.</p>
<p>You can use it like this 👇 I recommend adding this code to the main App component that CodeSandbox creates for you.</p>
<div class="sourceCode" id="cb29" data-caption="Use the Barchart" style="overflow: visible; margin: 1em 0;"><pre class="sourceCode javascript" style="overflow: visible; margin: 0;"><code class="sourceCode javascript" style="overflow: visible; white-space: pre; position: relative;"><a class="sourceLine" id="cb29-1" title="1" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="im">import</span> Barchart <span class="im">from</span> <span class="st" style="color: #4070a0;">&#39;./Barchart&#39;</span><span class="op" style="color: #666666;">;</span></a>
<a class="sourceLine" id="cb29-2" title="2" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;"></a>
<a class="sourceLine" id="cb29-3" title="3" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="co" style="color: #60a0b0; font-style: italic;">// ...</span></a>
<a class="sourceLine" id="cb29-4" title="4" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;"><span class="cf" style="color: #007020; font-weight: bold;">return</span> (</a>
<a class="sourceLine" id="cb29-5" title="5" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    <span class="op" style="color: #666666;">&lt;</span>svg width<span class="op" style="color: #666666;">=</span><span class="st" style="color: #4070a0;">&quot;800&quot;</span> height<span class="op" style="color: #666666;">=</span><span class="st" style="color: #4070a0;">&quot;600&quot;</span><span class="op" style="color: #666666;">&gt;</span></a>
<a class="sourceLine" id="cb29-6" title="6" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">        <span class="op" style="color: #666666;">&lt;</span>Barchart x<span class="op" style="color: #666666;">={</span><span class="dv" style="color: #40a070;">10</span><span class="op" style="color: #666666;">}</span> y<span class="op" style="color: #666666;">={</span><span class="dv" style="color: #40a070;">10</span><span class="op" style="color: #666666;">}</span> width<span class="op" style="color: #666666;">={</span><span class="dv" style="color: #40a070;">400</span><span class="op" style="color: #666666;">}</span> height<span class="op" style="color: #666666;">={</span><span class="dv" style="color: #40a070;">300</span><span class="op" style="color: #666666;">}</span> /&gt;</a>
<a class="sourceLine" id="cb29-7" title="7" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">    &lt;/svg<span class="op" style="color: #666666;">&gt;</span></a>
<a class="sourceLine" id="cb29-8" title="8" style="display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;">)</a></code></pre></div>
<p>But like I said, don’t use this in production. It’s great for quick prototypes, trying stuff out, or seeing how an existing visualization might fit your app.</p>